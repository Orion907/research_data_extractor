# Data Formats and Schemas (AI-Optimized)

This document describes the key data structures and formats used within the Research Data Extractor project.

## 1. Input Data

* **Research Articles:** Primary input documents are **PDF** files (e.g., Randomized Controlled Trials). The system primarily processes their textual content.
* **Research Protocols:** Input as **plain text (copied/pasted from Word documents)**, containing P.I.C.O.T.S. (Population, Intervention, Comparison, Outcome, Timing, Setting) information.

## 2. Intermediate Data

* **Text Chunks:** Raw text extracted from PDF articles and segmented into smaller, manageable chunks (plain text files) for LLM input (handled by `src/pdf_processor/text_chunker.py`).
* **Domain Profiles / Term Mappings:**
    * Stored as JSON files (e.g., `data/domain_profiles/diabetes_t2dm_domain_profile.json`).
    * These define semantic equivalences between medical terms and abbreviations, generated by `src/utils/domain_priming/`.
    * **Structure (example):**
        ```json
        {
          "canonical_term_1": ["synonym_a", "abbreviation_b", "variant_c"],
          "canonical_term_2": ["another_synonym", "another_abbrev"]
        }
        ```

## 3. Output Data

* **Extracted Data (Primary Output):**
    * Generated in **CSV format** by `src/data_export/csv_exporter.py`.
    * The specific columns and their content depend on the research protocol and LLM extraction.
    * **Implicit Schema:** The LLM is instructed to extract structured data (often in an intermediate JSON format which is then flattened to CSV).
    * **Example CSV columns might include:**
        * `Article_ID`
        * `Population_Size`
        * `Intervention_Name`
        * `Outcome_Measure_Value`
        * `Study_Duration`
        * `Setting`
        * `Extracted_Term_Normalized_1` (using term mapping)
    * **LLM's Intermediate Output (JSON - Example):** The LLM typically extracts data into a structured JSON object which is then converted.
        ```json
        {
          "articleId": "...",
          "population": {
            "size": 150,
            "description": "Adults with T2DM"
          },
          "intervention": {
            "name": "Metformin",
            "dose": "500 mg"
          },
          // ... other PICOTS fields ...
        }
        ```

* **Analytics Data:**
    * CSV and JSON files (e.g., `analytics/analytics_export_*.csv`, `analytics/extraction_stats.json`).
    * Contain metrics on extraction performance, LLM usage, etc.